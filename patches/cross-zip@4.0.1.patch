diff --git a/index.js b/index.js
index 94b61425f38d7f075ad41b6186905ab6d52dd994..924014f375b4cbb88dc310c7ebd3c088e7062816 100644
--- a/index.js
+++ b/index.js
@@ -46,7 +46,7 @@ function zip (inPath, outPath, cb) {
   // Windows zip command does not overwrite existing files. So do it manually first.
   function doZip () {
     if (process.platform === 'win32') {
-      fs.rmdir(outPath, { recursive: true, maxRetries: 3 }, doZip2)
+      fs.rm(outPath, { recursive: true, maxRetries: 3, force: true }, doZip2)
     } else {
       doZip2()
     }
@@ -72,7 +72,7 @@ function zipSync (inPath, outPath) {
       fs.writeFileSync(path.join(tmpPath, path.basename(inPath)), inFile)
       inPath = tmpPath
     }
-    fs.rmdirSync(outPath, { recursive: true, maxRetries: 3 })
+    fs.rmSync(outPath, { recursive: true, maxRetries: 3, force: true })
   }
   const opts = {
     cwd: path.dirname(inPath),
